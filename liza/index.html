<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>–° –ù–æ–≤—ã–º –ì–æ–¥–æ–º, –õ–∏–∑–æ—á–∫–∞!</title>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–æ–≤ -->
    <link
      href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Pacifico&family=Comfortaa:wght@400;700&family=Ruslan+Display&display=swap"
      rel="stylesheet"
    />

    <link
      href="https://cdn.jsdelivr.net/gh/Alaev-Co/snowflakes/dist/snow.min.css"
      rel="stylesheet"
    />

    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/MotionPathPlugin.min.js"></script>
    <script src="https://assets.codepen.io/16327/MorphSVGPlugin3.min.js"></script>
    <script src="https://assets.codepen.io/16327/DrawSVGPlugin3.min.js"></script>

    <style>
      :root {
        --bg-romance: linear-gradient(135deg, #ffdde1 0%, #ee9ca7 100%);
        --bg-night: #151522;
        --card-bg: #ffffff;
        --primary-red: #d6336c;
        --gold: #ffd700;
      }

      body,
      html {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
        font-family: "Comfortaa", cursive;
        background-color: var(--bg-night);
      }

      #app {
        width: 100%;
        height: 100%;
        position: relative;
      }

      /* --- –ì–ò–†–õ–Ø–ù–î–ê (–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏) --- */
      .lightrope {
        text-align: center;
        white-space: nowrap;
        overflow: hidden;
        position: fixed;
        top: 13px;
        z-index: 50;
        margin: -15px 0 0 0;
        padding: 0;
        pointer-events: none;
        width: 100%;
      }
      .lightrope li {
        position: relative;
        animation-fill-mode: both;
        animation-iteration-count: infinite;
        list-style: none;
        margin: 0;
        padding: 0;
        display: inline-block;
        width: 12px;
        height: 28px;
        border-radius: 50%;
        margin: 20px;
        background: rgba(0, 247, 165, 1);
        box-shadow: 0px 4.67px 24px 3px rgba(0, 247, 165, 1);
        animation-name: flash-1;
        animation-duration: 2s;
      }
      .lightrope li:nth-child(2n + 1) {
        background: rgba(0, 255, 255, 1);
        box-shadow: 0px 4.67px 24px 3px rgba(0, 255, 255, 0.5);
        animation-name: flash-2;
        animation-duration: 0.4s;
      }
      .lightrope li:nth-child(4n + 2) {
        background: rgba(247, 0, 148, 1);
        box-shadow: 0px 4.67px 24px 3px rgba(247, 0, 148, 1);
        animation-name: flash-3;
        animation-duration: 1.1s;
      }
      .lightrope li:nth-child(odd) {
        animation-duration: 1.8s;
      }
      .lightrope li:nth-child(3n + 1) {
        animation-duration: 1.4s;
      }
      .lightrope li:before {
        content: "";
        position: absolute;
        background: #222;
        width: 10px;
        height: 9.33px;
        border-radius: 3px;
        top: -4.67px;
        left: 1px;
      }
      .lightrope li:after {
        content: "";
        top: -14px;
        left: 9px;
        position: absolute;
        width: 52px;
        height: 18.67px;
        border-bottom: solid #222 2px;
        border-radius: 50%;
      }
      .lightrope li:last-child:after {
        content: none;
      }
      .lightrope li:first-child {
        margin-left: -40px;
      }
      @keyframes flash-1 {
        0%,
        100% {
          background: rgba(0, 247, 165, 1);
          box-shadow: 0px 4.67px 24px 3px rgba(0, 247, 165, 1);
        }
        50% {
          background: rgba(0, 247, 165, 0.4);
          box-shadow: 0px 4.67px 24px 3px rgba(0, 247, 165, 0.2);
        }
      }
      @keyframes flash-2 {
        0%,
        100% {
          background: rgba(0, 255, 255, 1);
          box-shadow: 0px 4.67px 24px 3px rgba(0, 255, 255, 1);
        }
        50% {
          background: rgba(0, 255, 255, 0.4);
          box-shadow: 0px 4.67px 24px 3px rgba(0, 255, 255, 0.2);
        }
      }
      @keyframes flash-3 {
        0%,
        100% {
          background: rgba(247, 0, 148, 1);
          box-shadow: 0px 4.67px 24px 3px rgba(247, 0, 148, 1);
        }
        50% {
          background: rgba(247, 0, 148, 0.4);
          box-shadow: 0px 4.67px 24px 3px rgba(247, 0, 148, 0.2);
        }
      }

      /* --- –≠–ö–†–ê–ù–´ --- */
      .screen {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.5s ease;
      }
      .screen.active {
        display: flex;
        opacity: 1;
      }

      /* –≠–ö–†–ê–ù 1: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ */
      #screen-welcome {
        background: var(--bg-romance);
        text-align: center;
      }
      .photos-container {
        position: relative;
        width: 350px;
        height: 250px;
        margin-bottom: 40px;
        animation: float 6s ease-in-out infinite;
      }
      .photo-wrapper {
        position: absolute;
        width: 180px;
        height: 180px;
        border-radius: 50%;
        overflow: hidden;
        border: 4px solid #fff;
        box-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
      }
      .photo-nik {
        top: 0;
        left: 0;
        z-index: 1;
        animation: orbit1 8s linear infinite;
      }
      .photo-liza {
        bottom: 0;
        right: 0;
        z-index: 2;
        animation: orbit2 8s linear infinite;
      }
      .photo-wrapper img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      @keyframes float {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-15px);
        }
      }
      @keyframes orbit1 {
        0% {
          transform: scale(1) rotate(0deg);
        }
        50% {
          transform: scale(1.1) rotate(5deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes orbit2 {
        0% {
          transform: scale(1) rotate(0deg);
        }
        50% {
          transform: scale(1.1) rotate(-5deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      .gift-container {
        cursor: pointer;
        margin-bottom: 20px;
        position: relative;
      }
      .gift-img {
        width: 180px;
        height: auto;
        animation: shake-jump 2s cubic-bezier(0.36, 0.07, 0.19, 0.97) infinite;
      }
      @keyframes shake-jump {
        10%,
        90% {
          transform: translate3d(-1px, 0, 0);
        }
        20%,
        80% {
          transform: translate3d(2px, 0, 0);
        }
        30%,
        50%,
        70% {
          transform: translate3d(-4px, -10px, 0) rotate(-2deg);
        }
        40%,
        60% {
          transform: translate3d(4px, 0, 0) rotate(2deg);
        }
      }
      .title-text {
        font-family: "Great Vibes", cursive;
        font-size: 3rem;
        color: #d6336c;
        margin: 0;
        text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.5);
      }
      .subtitle-text {
        font-size: 1rem;
        color: #fff;
        background: rgba(214, 51, 108, 0.4);
        padding: 5px 15px;
        border-radius: 20px;
        margin-top: 10px;
        animation: pulse 1.5s infinite;
      }
      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }

      /* –≠–ö–†–ê–ù 2: –ï–ª–∫–∞ */
      #screen-greeting {
        background-color: var(--bg-night);
      }
      #tree-svg {
        width: 133%;
        height: 81%;
        max-height: 500px;
        visibility: hidden;
        transform: translateY(-50px);
      }
      .greeting-content {
        z-index: 10;
        text-align: center;
        position: absolute;
        bottom: 50px;
        width: 100%;
      }
      .greeting-text {
        font-family: "Pacifico", cursive;
        color: #fff;
        font-size: 1.7rem;
        margin: 0 20px 20px 20px;
        text-shadow: 0 0 10px #ff0000;
      }
      .btn-magic {
        background: linear-gradient(45deg, #ff0000, #ff7300);
        color: white;
        border: none;
        padding: 15px 30px;
        font-size: 1rem;
        border-radius: 30px;
        font-family: "Comfortaa", cursive;
        font-weight: bold;
        box-shadow: 0 4px 15px rgba(255, 69, 0, 0.5);
        transition: transform 0.2s;
        outline: none;
      }
      .btn-magic:active {
        transform: scale(0.95);
      }
      .sparkle {
        mix-blend-mode: luminosity;
      }

      /* --- –ù–û–í–´–ï –°–¢–ò–õ–ò (–≠–ö–†–ê–ù 3 –∏ 4) --- */

      /* –≠–ö–†–ê–ù 3: –í–∏–∫—Ç–æ—Ä–∏–Ω–∞ */
      #screen-quiz {
        background-color: var(--bg-night);
        perspective: 1000px;
        overflow: hidden;
      }

      .quiz-stack {
        position: relative;
        width: 90%;
        max-width: 400px;
        height: 65vh;
        margin-top: 30px;
      }

      /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Å—Ç–µ–∫ –∫–∞—Ä—Ç–æ—á–µ–∫ –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–µ –±—É–¥—É—Ç —à–∏—Ä–µ */
      .quiz-stack {
        margin: 30px auto; /* —Ü–µ–Ω—Ç—Ä –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ */
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .quiz-card {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #fff;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        /* –£–±–∏—Ä–∞–µ–º CSS-–ø–µ—Ä–µ—Ö–æ–¥—ã —á—Ç–æ–±—ã GSAP —É–ø—Ä–∞–≤–ª—è–ª –∞–Ω–∏–º–∞—Ü–∏—è–º–∏ (–≤–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤) */
        transition: none;
        transform-origin: center bottom;
      }

      /* –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –∫–∞–∂–¥–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –Ω–µ –≤—ã–ª–µ–∑–µ—Ç –∑–∞ max-width —Å—Ç–µ–∫–∞ */
      .quiz-card {
        box-sizing: border-box;
        max-width: 400px;
        margin: 0 auto;
      }

      /* –í—ã–ø–∏—Ä–∞–Ω–∏–µ –∏ –Ω–∞–∫–ª–æ–Ω –∫–∞—Ä—Ç–æ—á–µ–∫ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Å—Ç–µ–∫–∞)
         –ü–æ–∑–∏—Ü–∏–∏ –∑–∞–¥–∞—é—Ç—Å—è CSS-–ø—Ä–∞–≤–∏–ª–∞–º–∏ –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π; –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ
         –ø–µ—Ä–µ—Å—á—ë—Ç—ã –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ JS —á–µ—Ä–µ–∑ GSAP, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä—É–∂–∏–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç. */
      .quiz-card:nth-child(1) {
        z-index: 3;
        transform: rotate(0deg) translateY(0) scale(1);
        opacity: 1;
      }
      .quiz-card:nth-child(2) {
        z-index: 2;
        transform: rotate(3deg) translateY(10px) scale(0.98);
        opacity: 0.95;
      }
      .quiz-card:nth-child(3) {
        z-index: 1;
        transform: rotate(-3deg) translateY(20px) scale(0.96);
        opacity: 0.85;
      }

      .quiz-card.swapped {
        /* –≠—Ç–æ—Ç –∫–ª–∞—Å—Å –≤—Å—ë –µ—â—ë –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –º–≥–Ω–æ–≤–µ–Ω–Ω—É—é –ø–æ–º–µ—Ç–∫—É; –∞–Ω–∏–º–∞—Ü–∏—è
           —Ç–µ–ø–µ—Ä—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ GSAP, —á—Ç–æ–±—ã –¥–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç –≤—ã–ª–µ—Ç–∞ */
        opacity: 0;
      }

      /* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –æ–±—ë—Ä—Ç–∫–∏ (–ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ–¥–∞—Ä–æ—á–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏) */
      .quiz-card::before {
        content: "";
        position: absolute;
        top: -6px;
        left: -6px;
        right: -6px;
        bottom: -6px;
        z-index: -1;
        border-radius: 26px;
        pointer-events: none;
        background-repeat: repeat;
        background-size: auto;
        background-position: center;
        mix-blend-mode: multiply;
        opacity: 0.95;
      }

      /* Pattern 1: –ø–æ–ª–æ—Å–∞—Ç–∞—è –ª–µ–Ω—Ç–∞ */
      .quiz-card.pattern-1::before {
        background-image: repeating-linear-gradient(
            90deg,
            firebrick,
            firebrick 20px,
            beige 0,
            beige 25px,
            forestgreen 0,
            forestgreen 35px,
            gold 0,
            gold 40px,
            crimson 0,
            crimson 60px
          ),
          repeating-linear-gradient(
            firebrick,
            firebrick 20px,
            beige 0,
            beige 25px,
            forestgreen 0,
            forestgreen 35px,
            gold 0,
            gold 40px,
            crimson 0,
            crimson 60px
          );
        background-blend-mode: multiply;
      }

      /* Pattern 2: –≥–æ—Ä–æ—à–µ–∫/–ø—É–≥–æ–≤–∏—Ü—ã */
      .quiz-card.pattern-2::before {
        background-image: radial-gradient(
            transparent 0,
            transparent 20px,
            #dc143c 0,
            #dc143c 25px,
            transparent 0,
            transparent 100%
          ),
          radial-gradient(
            transparent 0,
            transparent 20px,
            #dc143c 0,
            #dc143c 25px,
            transparent 0,
            transparent 100%
          ),
          radial-gradient(
            transparent 0,
            transparent 20px,
            #3cb371 0,
            #3cb371 25px,
            transparent 0,
            transparent 100%
          ),
          radial-gradient(
            transparent 0,
            transparent 20px,
            #3cb371 0,
            #3cb371 25px,
            transparent 0,
            transparent 100%
          ),
          linen;
        background-blend-mode: multiply;
        background-size: 80px 80px;
        background-position: 40px 40px, 40px 0, 0 0, 0 40px;
      }

      /* Pattern 3: –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
      .quiz-card.pattern-3::before {
        background-image: repeating-linear-gradient(
            to top left,
            wheat 0,
            wheat 20px,
            transparent 0,
            transparent 40px,
            #228b22 0,
            #228b22 60px
          ),
          repeating-linear-gradient(
            to left,
            crimson 0,
            crimson 20px,
            wheat 0,
            wheat 40px,
            #228b22 0,
            #228b22 60px
          ),
          beige;
        background-blend-mode: multiply;
      }

      /* –ß–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–≤–µ—Ä—Ö/–Ω–∏–∑ –∏–ª–∏ –ª–µ–≤–æ/–ø—Ä–∞–≤–æ –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–Ω—É—Ç—Ä–∏ flex column) */
      .card-content {
        display: flex;
        flex-direction: column;
        height: 100%;
      }

      /* –ß–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ —Å—Ç–∏–ª–µ–π –¥–ª—è —á–µ—Ç–Ω—ã—Ö/–Ω–µ—á–µ—Ç–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ */
      .quiz-card[data-layout="reverse"] .card-content {
        flex-direction: column-reverse;
      }

      .card-img {
        /* –ó–∞–Ω–∏–º–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ */
        flex: 1 1 auto;
        width: 100%;
        overflow: hidden;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 8px;
        box-sizing: border-box;
        background: #fafafa;
      }
      .card-img img {
        /* –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–º–µ—â–∞–µ—Ç—Å—è: */
        max-width: 100%;
        max-height: 100%;
        width: auto;
        height: auto;
        object-fit: contain;
        display: block;
      }

      .card-body {
        /* –¢–µ–∫—Å—Ç–æ–≤–∞—è —á–∞—Å—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–∞ –≤—ã—Ç–µ—Å–Ω—è—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Äî –∑–∞–Ω–∏–º–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–º–µ—Ä */
        flex: 0 0 auto;
        padding: 15px;
        background: #fff;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      .question-text {
        font-size: 1.1rem;
        color: #333;
        font-weight: 700;
        margin-bottom: 15px;
        line-height: 1.3;
      }

      .options {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .option-btn {
        background: linear-gradient(135deg, #fff8f0 0%, #ffecec 100%);
        border: 2px solid #ffd700;
        padding: 12px 14px;
        border-radius: 14px;
        text-align: left;
        font-size: 0.95rem;
        color: #2b2b2b;
        transition: transform 0.18s ease, box-shadow 0.18s ease;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08),
          inset 0 -4px 0 rgba(0, 0, 0, 0.02);
        position: relative;
        overflow: hidden;
      }
      .option-btn:hover {
        transform: translateY(-3px) scale(1.01);
        box-shadow: 0 10px 22px rgba(0, 0, 0, 0.12);
      }
      .option-btn::after {
        content: "";
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        width: 28px;
        height: 28px;
        background: radial-gradient(
          circle at 30% 30%,
          #fff 0%,
          rgba(255, 255, 255, 0) 40%
        );
        border-radius: 50%;
        opacity: 0.6;
      }
      .option-btn.correct {
        background: linear-gradient(135deg, #e6f9ea 0%, #d4edda 100%);
        border-color: #9fe0a8;
        color: #0b5f2b;
      }
      .option-btn.wrong {
        background: linear-gradient(135deg, #fdecea 0%, #f8d7da 100%);
        border-color: #f6b2b8;
        color: #7a2126;
      }

      /* –ú–æ–¥–∞–ª–∫–∞ —Å —Ñ–∞–∫—Ç–æ–º */
      .fact-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        z-index: 10;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 20px;
        box-sizing: border-box;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s;
        text-align: center;
        color: #fff;
        border-radius: 20px; /* –°–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–∞—Ä—Ç–æ—á–∫–æ–π */
      }
      .fact-answer {
        font-size: 1.8rem;
        font-weight: 800;
        margin-bottom: 12px;
        color: #fff;
        text-shadow: 0 2px 6px rgba(0, 0, 0, 0.6);
      }
      .fact-overlay.active {
        opacity: 1;
        pointer-events: all;
      }
      .fact-title {
        color: #ffd700;
        font-size: 1.2rem;
        margin-bottom: 10px;
        font-weight: bold;
      }
      .fact-text {
        font-size: 0.95rem;
        line-height: 1.5;
        margin-bottom: 20px;
      }
      .next-btn {
        background: var(--primary-red);
        color: white;
        padding: 10px 25px;
        border-radius: 20px;
        border: none;
        font-weight: bold;
      }

      /* –≠–ö–†–ê–ù 4: –§–∏–Ω–∞–ª –∏ –ø–æ–¥–∞—Ä–∫–∏ */
      #screen-final {
        background-color: var(--bg-night);
        color: #fff;
      }

      /* Final screen wrapper: —Ä–∞—Å—Ç—è–Ω—É—Ç—å –ø–æ –≤—Å–µ–π —à–∏—Ä–∏–Ω–µ –∏ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ */
      .final-wrapper {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        box-sizing: border-box;
      }

      /* –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —à–∏—Ä–∏–Ω—ã */
      .final-card {
        width: 100%;
        max-width: 360px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 20px;
      }

      /* –ó–∞–≥—Ä—É–∑–∫–∞ */
      .analysis-container {
        width: 80%;
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .loading-bar-wrapper {
        width: 100%;
        height: 20px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        overflow: visible; /* –ß—Ç–æ–±—ã –ª–∏–Ω–∏—è –≤—ã–ª–µ—Ç–µ–ª–∞ */
        position: relative;
        margin: 20px 0;
      }
      .loading-bar {
        width: 0%;
        height: 100%;
        background: linear-gradient(90deg, #ff0000, #ff7300);
        border-radius: 10px;
        position: relative;
      }
      /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è */
      .loading-bar.burst {
        width: 9999% !important; /* –í—ã—Ä—ã–≤–∞–µ—Ç—Å—è –∑–∞ –ø—Ä–µ–¥–µ–ª—ã */
        transition: width 2s cubic-bezier(0.1, 0.7, 1, 0.1);
      }
      .percent-text {
        font-size: 3rem;
        font-family: "Ruslan Display", cursive;
        color: var(--gold);
      }
      .analysis-text {
        font-size: 1.1rem;
        margin-bottom: 10px;
      }

      /* –ü–æ–¥–∞—Ä–æ—á–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ 3D */
      .gift-reveal-container {
        display: none; /* –°–∫—Ä—ã—Ç–æ –¥–æ –∫–æ–Ω—Ü–∞ –∑–∞–≥—Ä—É–∑–∫–∏ */
        width: 85%;
        height: 60vh;
        perspective: 1000px;
        flex-direction: column;
        align-items: center;
      }

      /* –û–≥—Ä–∞–Ω–∏—á–∏–º —à–∏—Ä–∏–Ω—É 3D-–∫–∞—Ä—Ç–æ—á–∫–∏ –∏ —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –µ—ë –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
      .gift-card-3d {
        max-width: 420px;
        margin: 0 auto;
      }

      .gift-card-3d {
        width: 100%;
        height: 100%;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 1.2s cubic-bezier(0.4, 0.2, 0.2, 1);
        cursor: pointer;
      }

      .gift-card-3d.flipped {
        transform: rotateY(180deg);
      }

      .card-face {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
      }

      .face-front {
        background: linear-gradient(135deg, #fff 0%, #f0f0f0 100%);
        flex-direction: column;
        padding: 20px;
        text-align: center;
        border: 4px solid var(--primary-red);
      }

      .face-back {
        background: #fff;
        transform: rotateY(180deg);
        padding: 10px;
      }

      .face-back img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        border-radius: 10px;
      }

      .gift-msg {
        color: var(--primary-red);
        font-family: "Great Vibes", cursive;
        font-size: 2.5rem;
        margin-bottom: 15px;
      }
      .tap-hint {
        color: #555;
        font-size: 0.9rem;
        animation: pulse 2s infinite;
      }

      /* –ö–Ω–æ–ø–∫–∞ "–ï—â–µ –Ω–µ –≤—Å–µ" */
      .more-gifts-btn {
        margin-top: 25px;
        background: var(--gold);
        color: #333;
        border: none;
        padding: 12px 24px;
        border-radius: 30px;
        font-weight: bold;
        font-size: 1.1rem;
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
        display: none; /* –ü–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç–∞ */
        opacity: 0;
        transition: opacity 0.5s;
        transform: translateY(34px);
      }

      /* –ü–ï–†–ï–•–û–î (TRANSITION OVERLAY) */
      #transition-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to bottom, #fff, #e3f2fd);
        z-index: 999;
        transform: translateY(-100%);
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: none;
      }
      .snow-transition {
        font-family: "Mountains of Christmas", cursive;
        font-size: 2rem;
        color: #a2cbdc;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <!-- –ì–∏—Ä–ª—è–Ω–¥–∞ -->
      <ul class="lightrope">
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
      </ul>

      <!-- –≠–ö–†–ê–ù 1: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
      <div id="screen-welcome" class="screen active">
        <div class="photos-container">
          <div class="photo-wrapper photo-nik">
            <img
              src="/liza/nik.png"
              alt="–ù–∏–∫–∏—Ç–∞"
              onerror="this.src='https://placehold.co/120x120?text=Nik'"
            />
          </div>
          <div class="photo-wrapper photo-liza">
            <img
              src="/liza/liza.png"
              alt="–õ–∏–∑–∞"
              onerror="this.src='https://placehold.co/120x120?text=Liza'"
            />
          </div>
        </div>
        <div class="gift-container" onclick="handleGiftClick()">
          <img src="/liza/present1.png" class="gift-img" alt="–ü–æ–¥–∞—Ä–æ–∫" />
        </div>
        <h1 class="title-text">–õ–∏–∑–æ—á–∫–µ</h1>
        <div class="subtitle-text">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å ‚ú®</div>
      </div>

      <!-- –≠–ö–†–ê–ù 2: –ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –ï–ª–∫–∞ -->
      <div id="screen-greeting" class="screen">
        <!-- SVG Code preserved from original -->
        <svg
          id="tree-svg"
          class="mainSVG"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 800 600"
        >
          <defs>
            <radialGradient
              id="dotGrad"
              cx="0"
              cy="0"
              r="50"
              gradientUnits="userSpaceOnUse"
            >
              <stop offset="0" style="stop-color: #ffffff; stop-opacity: 1" />
              <stop
                offset="0.1"
                style="stop-color: #0867c7; stop-opacity: 0.6"
              />
              <stop offset="1" style="stop-color: #081029; stop-opacity: 0" />
            </radialGradient>
            <mask id="treePathMask">
              <path
                class="treePathMask"
                fill="none"
                stroke-width="18"
                stroke="#FFF"
                d="M252.9,447.9c0,0-30.8-21.6,33.9-44.7c64.7-23.1,46.2-37,33.9-41.6c-12.3-4.6-59.3-11.6-42.4-28.5s114-52.4,81.7-66.2c-32.4-13.9-58.5-10.8-35.4-29.3s66.2-101.7,70.9-115.6c4.4-13.2,16.9-18.5,24.7,0c7.7,18.5,44.7,100.1,67.8,115.6c23.1,15.4-10.8,21.6-26.2,24.7c-15.4,3.1-20,33.9,33.9,49.3c53.9,15.4,47.8,40.1,27.7,44.7c-20,4.6-63.2,4.6-27.7,32.4s98.6,21.6,61.6,60.1"
              />
            </mask>
            <mask id="treeBottomMask">
              <path
                class="treeBottomMask"
                stroke="#FFF"
                stroke-width="8"
                d="M207.5,484.1c0,0,58.5-43.1,211.1-3.1s191-16.9,191-16.9"
              />
            </mask>
            <mask id="treePotMask">
              <path
                class="treePotMask"
                stroke="#FFF"
                stroke-width="8"
                d="M374.3,502.5c0,0-4.6,20,7.7,29.3c12.3,9.2,40.1,7.7,50.8,0s10.8-23.1,10.8-29.3"
              />
            </mask>
          </defs>
          <g class="whole">
            <g class="pContainer"></g>
            <g class="tree" mask="url(#treePathMask)">
              <path
                d="M252.95,447.85a20.43,20.43,0,0,1-5.64-6.24,14,14,0,0,1-1.91-8.22,16.93,16.93,0,0,1,3.06-8,33.16,33.16,0,0,1,5.79-6.28A74.78,74.78,0,0,1,268.54,410a163.48,163.48,0,0,1,15.52-6.84c10.54-3.93,21-8.07,30.72-13.46a80.83,80.83,0,0,0,7-4.37,37.51,37.51,0,0,0,6.13-5.24c1.75-1.92,3.14-4.18,3.25-6.35s-1.12-4.18-3-5.81a25,25,0,0,0-6.72-3.91,61.25,61.25,0,0,0-7.8-2.42c-5.41-1.4-10.91-2.72-16.38-4.32a84.17,84.17,0,0,1-16.2-6.19,28.26,28.26,0,0,1-3.86-2.5,15.06,15.06,0,0,1-3.44-3.63,9,9,0,0,1-1.51-5.47,10.22,10.22,0,0,1,.61-2.78,12.88,12.88,0,0,1,1.2-2.34,26.73,26.73,0,0,1,6.58-6.56c2.35-1.76,4.76-3.33,7.19-4.84,4.87-3,9.82-5.75,14.77-8.46,9.91-5.4,19.88-10.59,29.63-16.08,4.87-2.75,9.68-5.56,14.33-8.56A81.88,81.88,0,0,0,359.45,280a23,23,0,0,0,2.41-2.79,8.36,8.36,0,0,0,1.35-2.65,2.13,2.13,0,0,0-.17-1.7,5.53,5.53,0,0,0-1.88-1.77,13.15,13.15,0,0,0-1.49-.83c-.52-.26-1.1-.49-1.76-.77-1.27-.53-2.55-1-3.83-1.53q-3.86-1.48-7.8-2.77c-5.26-1.74-10.6-3.23-16-4.79-2.72-.79-5.47-1.58-8.29-2.61a31.74,31.74,0,0,1-4.33-1.92,14.39,14.39,0,0,1-2.29-1.53,8.74,8.74,0,0,1-2.22-2.66,7.2,7.2,0,0,1-.78-4,9.09,9.09,0,0,1,1-3.24,18.93,18.93,0,0,1,3-4.21,44.88,44.88,0,0,1,3.29-3.19c.56-.5,1.12-1,1.68-1.45l1.61-1.33a84,84,0,0,0,10.88-11.88,326.2,326.2,0,0,0,18.79-27.53c5.88-9.5,11.48-19.19,16.89-29S380.1,146.16,385,136.13c1.22-2.51,2.42-5,3.57-7.54s2.29-5.09,3.14-7.45l.36-1c.14-.38.26-.75.42-1.12.29-.75.64-1.48,1-2.21a25.51,25.51,0,0,1,2.65-4.21,19.15,19.15,0,0,1,3.76-3.69,13.74,13.74,0,0,1,5.24-2.42,12.11,12.11,0,0,1,6.12.25,14.59,14.59,0,0,1,5,2.79,20.59,20.59,0,0,1,3.47,3.79,30.33,30.33,0,0,1,2.5,4.1c.35.7.7,1.39,1,2.1l.46,1.05.4,1,1.64,3.84,3.39,7.67q6.88,15.32,14.36,30.37c5,10,10.18,19.94,15.69,29.65a274.94,274.94,0,0,0,17.9,28A73.36,73.36,0,0,0,487.74,233c.49.4,1,.8,1.48,1.15l1.7,1.19a35,35,0,0,1,3.66,3,17.84,17.84,0,0,1,3.32,4.08,10.83,10.83,0,0,1,1.14,2.94,8.54,8.54,0,0,1,0,3.54,10.27,10.27,0,0,1-3.22,5.39,20.71,20.71,0,0,1-4.15,2.91,49,49,0,0,1-8.4,3.46,154,154,0,0,1-16.77,4.09l-4.15.81a9.18,9.18,0,0,0-2.87,1.08,9.51,9.51,0,0,0-4,4.7,12.55,12.55,0,0,0-.67,6.58,19.5,19.5,0,0,0,2.46,6.74A37.19,37.19,0,0,0,468,295.75a75,75,0,0,0,14.14,7.86,129.67,129.67,0,0,0,15.58,5.49A141.4,141.4,0,0,1,513.88,315a75,75,0,0,1,15.19,8.65,37.29,37.29,0,0,1,6.55,6.24,21.05,21.05,0,0,1,4.31,8.49,14.43,14.43,0,0,1-1.24,9.88,18.08,18.08,0,0,1-6.66,6.94,26.74,26.74,0,0,1-8.56,3.33c-2.84.61-5.65,1.06-8.44,1.49-5.58.86-11.13,1.61-16.52,2.77a53.48,53.48,0,0,0-7.81,2.22c-2.43.94-4.81,2.22-6,3.93a4.34,4.34,0,0,0-.77,2.82,8.45,8.45,0,0,0,1,3.29,28,28,0,0,0,4.82,6.25,80.74,80.74,0,0,0,12.81,10.4c9.29,6,19.72,10.29,30.24,14.17,5.27,1.95,10.59,3.79,15.85,5.86,2.63,1,5.24,2.14,7.79,3.39a37.94,37.94,0,0,1,7.28,4.51,11.9,11.9,0,0,1,3.63,15.57,34.68,34.68,0,0,1-4.53,7.16,77.45,77.45,0,0,1-5.64,6.29,77.31,77.31,0,0,0,5.41-6.46,34.27,34.27,0,0,0,4.22-7.21,12.64,12.64,0,0,0,.88-8,12.44,12.44,0,0,0-4.71-6.43,37.71,37.71,0,0,0-7.15-4.16c-2.53-1.16-5.13-2.18-7.76-3.14-5.26-1.91-10.62-3.62-16-5.44-10.65-3.63-21.34-7.64-31.11-13.64a83.84,83.84,0,0,1-13.61-10.49,31.27,31.27,0,0,1-5.6-6.94,12,12,0,0,1-1.55-4.68,8.17,8.17,0,0,1,.19-2.7,8.56,8.56,0,0,1,1.09-2.5,12.1,12.1,0,0,1,3.6-3.44,24.27,24.27,0,0,1,4.08-2.08,57.3,57.3,0,0,1,8.36-2.56c5.59-1.31,11.19-2.17,16.71-3.12,2.76-.48,5.5-1,8.15-1.59a22.1,22.1,0,0,0,7-2.87,13.3,13.3,0,0,0,4.82-5.15,9.42,9.42,0,0,0,.69-6.53,16,16,0,0,0-3.42-6.33,33.25,33.25,0,0,0-5.73-5.27,69.74,69.74,0,0,0-14.19-7.8,135.81,135.81,0,0,0-15.61-5.42,135.53,135.53,0,0,1-16.3-5.51,81,81,0,0,1-15.41-8.31,43.39,43.39,0,0,1-12.6-13,25.53,25.53,0,0,1-3.34-9,19.13,19.13,0,0,1,1-10,16.17,16.17,0,0,1,6.69-8,15.88,15.88,0,0,1,5-1.93l4.13-.84a147.75,147.75,0,0,0,16-4,42.41,42.41,0,0,0,7.17-3,14,14,0,0,0,2.74-1.92,3.42,3.42,0,0,0,1.12-1.68,2.41,2.41,0,0,0-.43-1.61,11.07,11.07,0,0,0-2-2.4,28,28,0,0,0-2.92-2.31l-1.76-1.22c-.65-.46-1.26-.94-1.86-1.43a59,59,0,0,1-6.43-6.27c-2-2.19-3.79-4.44-5.54-6.74a267,267,0,0,1-18.55-28.74c-5.63-9.85-10.89-19.86-16-30s-9.91-20.31-14.57-30.61l-3.45-7.76L417,124.48l-.42-1-.39-.88c-.25-.59-.54-1.15-.82-1.71a22.74,22.74,0,0,0-1.89-3.09,13,13,0,0,0-2.2-2.42,7,7,0,0,0-2.31-1.33,4.49,4.49,0,0,0-2.22-.09,8.55,8.55,0,0,0-4.59,3.32,17.85,17.85,0,0,0-1.84,2.92c-.26.54-.51,1.07-.73,1.64-.12.27-.22.56-.32.85l-.35,1c-1.06,2.93-2.23,5.47-3.42,8.1s-2.42,5.16-3.67,7.7c-5,10.18-10.29,20.16-15.77,30.05s-11.17,19.66-17.16,29.28a310.2,310.2,0,0,1-19.39,28.11,90.46,90.46,0,0,1-12,12.85l-1.65,1.35c-.52.43-1,.85-1.53,1.29a38,38,0,0,0-2.79,2.65,12.42,12.42,0,0,0-1.94,2.57,2.33,2.33,0,0,0-.28.76c0,.11,0,0,0,.09a4.57,4.57,0,0,0,1.7,1.35,25.15,25.15,0,0,0,3.36,1.51c2.46.92,5.11,1.72,7.79,2.52,5.36,1.58,10.84,3.16,16.25,5q4.06,1.37,8.08,2.94c1.34.53,2.67,1.07,4,1.63.64.27,1.36.57,2.1.94a19.66,19.66,0,0,1,2.18,1.24,11.85,11.85,0,0,1,4,4.13,8.64,8.64,0,0,1,1,3.24,9.11,9.11,0,0,1-.27,3.23,14.48,14.48,0,0,1-2.42,4.85,29.32,29.32,0,0,1-3.14,3.56,87.46,87.46,0,0,1-14,10.47c-4.85,3-9.79,5.84-14.76,8.55-9.94,5.42-20,10.49-29.91,15.72-5,2.62-9.88,5.28-14.63,8.12-2.37,1.42-4.7,2.89-6.88,4.46a22.06,22.06,0,0,0-5.45,5.14,8,8,0,0,0-.76,1.39,5.36,5.36,0,0,0-.33,1.32,4.1,4.1,0,0,0,.69,2.53,15.62,15.62,0,0,0,5.49,4.62A80.14,80.14,0,0,0,298.56,353c5.31,1.66,10.73,3.06,16.18,4.58a64.81,64.81,0,0,1,8.26,2.74,27.74,27.74,0,0,1,7.69,4.74,13.65,13.65,0,0,1,3,3.81,9.27,9.27,0,0,1,1,5,11.14,11.14,0,0,1-1.54,4.7,19.09,19.09,0,0,1-2.8,3.67,40.6,40.6,0,0,1-6.81,5.54,83.78,83.78,0,0,1-7.41,4.35c-10.11,5.26-20.76,9.16-31.39,12.82a161.69,161.69,0,0,0-15.52,6.37A74.57,74.57,0,0,0,255,420a32.17,32.17,0,0,0-5.82,5.89,16.21,16.21,0,0,0-3.19,7.52,13.61,13.61,0,0,0,1.59,8A20.29,20.29,0,0,0,252.95,447.85Z"
                fill="#cb9866"
              />
              <path
                d="M207.5,484.06c7.05-5.11,15.14-8.66,23.34-11.63a177.13,177.13,0,0,1,25.29-6.88,263.65,263.65,0,0,1,52.22-4.49h3.28l3.28.09,6.56.19,6.55.39c2.18.13,4.37.26,6.54.48,4.35.39,8.71.74,13,1.28l6.51.75,6.49.91c17.3,2.5,34.41,6,51.36,10.19l12.62,3.2c4.18,1,8.34,2.18,12.55,3.06,8.38,2,16.82,3.63,25.29,5.13a353.5,353.5,0,0,0,51.17,5.47c17.11.32,34.36-.66,51-4.7a118.55,118.55,0,0,0,24.21-8.47,84.82,84.82,0,0,0,11.11-6.49,47.55,47.55,0,0,0,9.69-8.53,48.1,48.1,0,0,1-9,9.45,85.1,85.1,0,0,1-10.81,7.45,116.56,116.56,0,0,1-24.23,10.24,165.66,165.66,0,0,1-25.79,5.35,232.1,232.1,0,0,1-26.27,1.71c-8.77,0-17.55-.24-26.26-1.09-2.18-.2-4.37-.35-6.54-.6l-6.52-.78c-4.36-.46-8.67-1.19-13-1.82-8.64-1.37-17.22-3.09-25.74-5-4.28-.87-8.5-2-12.75-3l-12.62-3.11q-25.06-6.37-50.58-10.47a426.37,426.37,0,0,0-51.3-5.3c-8.59-.42-17.19-.29-25.78,0a240.1,240.1,0,0,0-25.68,2.24,186.57,186.57,0,0,0-25.27,5.19c-4.15,1.16-8.26,2.49-12.28,4.05-2,.79-4,1.6-6,2.52A50.82,50.82,0,0,0,207.5,484.06Z"
                fill="#cb9866"
              />
              <path
                d="M374.32,502.55a48.15,48.15,0,0,0,1.24,14.35c1.15,4.52,3.29,8.64,6.49,11.35a18.5,18.5,0,0,0,5.51,3.14,39.06,39.06,0,0,0,6.41,1.82,65.78,65.78,0,0,0,13.68,1.12,72.9,72.9,0,0,0,13.72-1.44,44.51,44.51,0,0,0,6.46-1.85,17.75,17.75,0,0,0,5.51-3.15,25.45,25.45,0,0,0,7.24-11.17,52,52,0,0,0,1.9-6.91c.48-2.37.83-4.8,1.18-7.25a55.16,55.16,0,0,1,.64,7.42,40.11,40.11,0,0,1-.52,7.56,31.23,31.23,0,0,1-2.19,7.5,24.37,24.37,0,0,1-4.46,6.79,25.16,25.16,0,0,1-6.61,5,39.72,39.72,0,0,1-7.4,3A58.55,58.55,0,0,1,407.75,542a55,55,0,0,1-15.47-1.9,36.65,36.65,0,0,1-7.46-3,25.3,25.3,0,0,1-6.6-5,19.63,19.63,0,0,1-2.5-3.34,21.72,21.72,0,0,1-1.79-3.67,27.66,27.66,0,0,1-1.65-7.7,38.16,38.16,0,0,1,2-14.87Z"
                fill="#cb9866"
              />
            </g>
            <path
              class="treeBottomPath"
              stroke="none"
              fill="none"
              stroke-width="8"
              d="M207.5,484.1c0,0,58.5-43.1,211.1-3.1s191-16.9,191-16.9"
            />
            <path
              class="treePath"
              fill="none"
              stroke="none"
              stroke-miterlimit="10"
              d="M252.95,447.85s-30.81-21.57,33.89-44.68,46.22-37,33.89-41.6-59.32-11.56-42.37-28.5,114-52.38,81.66-66.25S301.48,256,324.59,237.55,390.84,135.87,395.46,122c4.41-13.24,16.95-18.49,24.65,0s44.68,100.14,67.79,115.55-10.78,21.57-26.19,24.65-20,33.89,33.89,49.3,47.76,40.06,27.73,44.68-63.17,4.62-27.73,32.35,98.6,21.57,61.63,60.09"
            />
            <path
              class="treeBottom"
              mask="url(#treeBottomMask)"
              d="M207.5,484.06c7.05-5.11,15.14-8.66,23.34-11.63a177.13,177.13,0,0,1,25.29-6.88,263.65,263.65,0,0,1,52.22-4.49h3.28l3.28.09,6.56.19,6.55.39c2.18.13,4.37.26,6.54.48,4.35.39,8.71.74,13,1.28l6.51.75,6.49.91c17.3,2.5,34.41,6,51.36,10.19l12.62,3.2c4.18,1,8.34,2.18,12.55,3.06,8.38,2,16.82,3.63,25.29,5.13a353.5,353.5,0,0,0,51.17,5.47c17.11.32,34.36-.66,51-4.7a118.55,118.55,0,0,0,24.21-8.47,84.82,84.82,0,0,0,11.11-6.49,47.55,47.55,0,0,0,9.69-8.53,48.1,48.1,0,0,1-9,9.45,85.1,85.1,0,0,1-10.81,7.45,116.56,116.56,0,0,1-24.23,10.24,165.66,165.66,0,0,1-25.79,5.35,232.1,232.1,0,0,1-26.27,1.71c-8.77,0-17.55-.24-26.26-1.09-2.18-.2-4.37-.35-6.54-.6l-6.52-.78c-4.36-.46-8.67-1.19-13-1.82-8.64-1.37-17.22-3.09-25.74-5-4.28-.87-8.5-2-12.75-3l-12.62-3.11q-25.06-6.37-50.58-10.47a426.37,426.37,0,0,0-51.3-5.3c-8.59-.42-17.19-.29-25.78,0a240.1,240.1,0,0,0-25.68,2.24,186.57,186.57,0,0,0-25.27,5.19c-4.15,1.16-8.26,2.49-12.28,4.05-2,.79-4,1.6-6,2.52A50.82,50.82,0,0,0,207.5,484.06Z"
              fill="#cb9866"
            />
            <path
              class="treePot"
              mask="url(#treePotMask)"
              d="M374.32,502.55a48.15,48.15,0,0,0,1.24,14.35c1.15,4.52,3.29,8.64,6.49,11.35a18.5,18.5,0,0,0,5.51,3.14,39.06,39.06,0,0,0,6.41,1.82,65.78,65.78,0,0,0,13.68,1.12,72.9,72.9,0,0,0,13.72-1.44,44.51,44.51,0,0,0,6.46-1.85,17.75,17.75,0,0,0,5.51-3.15,25.45,25.45,0,0,0,7.24-11.17,52,52,0,0,0,1.9-6.91c.48-2.37.83-4.8,1.18-7.25a55.16,55.16,0,0,1,.64,7.42,40.11,40.11,0,0,1-.52,7.56,31.23,31.23,0,0,1-2.19,7.5,24.37,24.37,0,0,1-4.46,6.79,25.16,25.16,0,0,1-6.61,5,39.72,39.72,0,0,1-7.4,3A58.55,58.55,0,0,1,407.75,542a55,55,0,0,1-15.47-1.9,36.65,36.65,0,0,1-7.46-3,25.3,25.3,0,0,1-6.6-5,19.63,19.63,0,0,1-2.5-3.34,21.72,21.72,0,0,1-1.79-3.67,27.66,27.66,0,0,1-1.65-7.7,38.16,38.16,0,0,1,2-14.87Z"
              fill="#cb9866"
            />
            <g class="treeStar">
              <path
                class="treeStarOutline"
                opacity="0"
                d="M421,53.27c5,.83,10.08,1.52,15.15,2.13l3.8.45,1.9.21c.33,0,.6.06,1,.12a2.41,2.41,0,0,1,1.27.66,2.52,2.52,0,0,1,.56,2.76,3.42,3.42,0,0,1-.78,1.07l-.66.69-2.65,2.77c-1.78,1.83-3.54,3.68-5.35,5.48l-2.7,2.71L429.81,75l-.69.67-.34.33,0,0h0a.14.14,0,0,0,0-.08s0-.07,0,0l0,.24.07.47.57,3.78c.4,2.52.71,5,1.06,7.57l.94,7.59.22,1.9c0,.06,0,.19,0,.34a2.21,2.21,0,0,1,0,.43,2.72,2.72,0,0,1-.21.84,2.85,2.85,0,0,1-2.65,1.75,2.57,2.57,0,0,1-.82-.14,3.12,3.12,0,0,1-.65-.3l-1.64-1-6.58-3.91-6.63-3.81-3.34-1.86-.42-.23-.21-.12-.14-.07a1,1,0,0,0-.59,0,1.15,1.15,0,0,0-.31.12l-.43.22-.85.44c-2.27,1.17-4.54,2.31-6.79,3.52s-4.51,2.38-6.74,3.61l-3.36,1.83-.84.46a3.07,3.07,0,0,1-1.28.44,2.68,2.68,0,0,1-2.84-3l.15-1,.29-1.89.57-3.78,1.18-7.56,1.24-7.52a.13.13,0,0,0,0,.08l0,0-.1-.09-.17-.17-1.37-1.34-2.73-2.68-10.93-10.7-.34-.33a4,4,0,0,1-.64-.84,3.63,3.63,0,0,1-.43-2.12,3.68,3.68,0,0,1,2.64-3.17l.52-.11.25,0,.47-.06.95-.12,1.9-.25,7.58-1,7.6-.9,1.9-.23.95-.11c.24,0,.11,0,.09,0l-.09.05-.07.08,0,0,.09-.16.46-.84.91-1.68c2.41-4.5,4.95-8.92,7.51-13.34l1-1.66.48-.83.24-.41.13-.23a3.49,3.49,0,0,1,.22-.33,2.66,2.66,0,0,1,2.83-.9,2.52,2.52,0,0,1,1.26.84,2.85,2.85,0,0,1,.37.62l.18.44q1.45,3.54,3,7.06c1,2.36,2,4.68,3.06,7,.51,1.17,1.06,2.32,1.59,3.48l.8,1.74a2.12,2.12,0,0,0,.45.75A1.42,1.42,0,0,0,421,53.27Zm-.06.39a1.82,1.82,0,0,1-1-.46,2.52,2.52,0,0,1-.56-.86l-.84-1.72c-.56-1.14-1.11-2.3-1.69-3.43-1.17-2.27-2.29-4.56-3.5-6.81s-2.39-4.51-3.6-6.76l-.23-.42a.8.8,0,0,0-.14-.18.58.58,0,0,0-.33-.15.56.56,0,0,0-.57.28L407,36.48c-2.09,4.66-4.2,9.31-6.45,13.88l-.83,1.72-.42.86-.13.27a3.57,3.57,0,0,1-2,1.67,4.26,4.26,0,0,1-.84.18l-.95.13-1.89.27L386,56.53l-7.58,1-3.49.44a.45.45,0,0,0,.34-.4.51.51,0,0,0-.07-.28s-.06-.08-.07-.08l.33.34,10.65,11,2.66,2.75,1.33,1.37.4.42a3.41,3.41,0,0,1,.53.84,3.36,3.36,0,0,1,.24,1.95c-.53,2.56-1,5-1.57,7.52L388,90.85l-.83,3.73-.42,1.87-.2.9a.5.5,0,0,0,0,.3.58.58,0,0,0,.52.37,6.28,6.28,0,0,0,1.38-.58l3.46-1.62q3.47-1.61,6.9-3.3c2.3-1.1,4.57-2.26,6.85-3.39l.86-.43.43-.21a2.55,2.55,0,0,1,.57-.22,2.21,2.21,0,0,1,1.29.08l.29.13.21.11.42.23,3.37,1.81,6.8,3.51,6.85,3.41,1.71.85c.19.09.15.07.22.08a.25.25,0,0,0,.12,0,.42.42,0,0,0,.21-.1.33.33,0,0,0,.1-.19.2.2,0,0,0,0-.09.1.1,0,0,0,0,0l0-.13L428.74,96l-1.42-7.52c-.43-2.51-.9-5-1.29-7.54l-.6-3.78-.08-.47,0-.24a3.75,3.75,0,0,1,0-.45,3.37,3.37,0,0,1,.52-1.9,3.33,3.33,0,0,1,.3-.4,3.73,3.73,0,0,1,.3-.3l.35-.32.7-.65,2.81-2.59,2.86-2.54c1.9-1.71,3.84-3.36,5.77-5l2.91-2.49a12.91,12.91,0,0,0,1.15-1,.7.7,0,0,0-.06-.79.73.73,0,0,0-.37-.26c-.23-.06-.6-.13-.89-.2l-1.87-.4L436,56.39C431,55.39,426,54.45,420.95,53.66Z"
                fill="#FFFCF9"
              />
              <path
                d="M408.12,83.45l-17.78,8.94,3.72-19.55-14-14.15,19.74-2.5,9.13-17.68,8.48,18L437,59.73l-14.5,13.63,3,19.67Z"
                fill="#C89568"
              />
            </g>
            <circle class="sparkle" fill="url(#dotGrad)" cx="0" cy="0" r="50" />
          </g>
        </svg>
        <div class="greeting-content">
          <div class="greeting-text">
            –ñ–µ–ª–∞—é —Å—É–ø–µ—Ä—Å–∫–æ–≥–æ –ù–æ–≤–æ–≥–æ –ì–æ–¥–∞! <br />
            –°–∏–ª—å–Ω–æ —Å–∏–ª—å–Ω–æ –ª—é–±–ª—é –∏ –æ–±–∏–º–∞—éüíò
          </div>
          <button class="btn-magic" onclick="handleLastButton()">
            –í—Å–ø–æ–º–Ω–∏—Ç—å —ç—Ç–æ—Ç —á—É–¥–µ—Å–Ω—ã–π –≥–æ–¥
          </button>
        </div>
      </div>

      <!-- –≠–ö–†–ê–ù 3: –í–∏–∫—Ç–æ—Ä–∏–Ω–∞ -->
      <div id="screen-quiz" class="screen">
        <div class="quiz-stack" id="quiz-stack">
          <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è JS -->
        </div>
      </div>

      <!-- –≠–ö–†–ê–ù 4: –§–∏–Ω–∞–ª (–ê–Ω–∞–ª–∏–∑ + –ü–æ–¥–∞—Ä–æ–∫) -->
      <div id="screen-final" class="screen">
        <div class="final-wrapper">
          <div class="final-card">
            <!-- 1. –ê–Ω–∞–ª–∏–∑ -->
            <div class="analysis-container" id="analysis-container">
              <div class="analysis-text">–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –≤—Å–µ –æ—Ç–≤–µ—Ç—ã...</div>
              <div class="analysis-text">
                –û–ø—Ä–µ–¥–µ–ª—è—é, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç—ã –∫—Ä–∞—Å–∏–≤–∞—è...
              </div>
              <div class="loading-bar-wrapper">
                <div class="loading-bar" id="loading-bar"></div>
              </div>
              <div class="percent-text" id="percent-text">0%</div>
            </div>

            <!-- 2. –ü–æ–¥–∞—Ä–æ–∫ -->
            <div class="gift-reveal-container" id="gift-reveal-container">
              <div
                class="gift-card-3d"
                id="gift-card-3d"
                onclick="flipGiftCard()"
              >
                <div class="card-face face-front">
                  <div class="gift-msg" id="gift-front-text">
                    –Ø –¥–∞—Ä—é —Ç–µ–±–µ...
                  </div>
                  <div class="tap-hint">(–Ω–∞–∂–º–∏, —á—Ç–æ–±—ã –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å)</div>
                </div>
                <div class="card-face face-back">
                  <img
                    id="gift-img"
                    src="/liza/certificate1.png"
                    alt="–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç 1"
                    onerror="this.src='https://placehold.co/300x400?text=Gift+1'"
                  />
                </div>
              </div>
              <button
                class="more-gifts-btn"
                id="more-gifts-btn"
                onclick="nextGift(event)"
              >
                –ê —ç—Ç–æ –µ—â–µ –Ω–µ –≤—Å–µ!!
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –¢–†–ê–ù–ó–ò–®–ù (–ü–ï–†–ï–•–û–î) -->
    <div id="transition-overlay">
      <div class="snow-transition">‚ùÑÔ∏è ‚ùÑÔ∏è ‚ùÑÔ∏è</div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/Alaev-Co/snowflakes/dist/Snow.min.js"></script>
    <script>
      new Snow();

      // === –î–ê–ù–ù–´–ï –í–ò–ö–¢–û–†–ò–ù–´ ===
      const quizData = [
        {
          img: "/liza/q1.png",
          question:
            "–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ —ç—Ç–æ—Ç –≥–æ–¥ –º—ã —Å —Ç–æ–±–æ–π –ø—Ä–æ–≥–æ–≤–æ—Ä–∏–ª–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É?",
          correct: 1, // –ò–Ω–¥–µ–∫—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
          options: [
            "490 –º–∏–Ω—É—Ç",
            "10 –¥–Ω–µ–π, 1 —á–∞—Å –∏ 55 –º–∏–Ω—É—Ç",
            "50 —á–∞—Å–æ–≤",
            "–í–µ—á–Ω–æ—Å—Ç—å –≤ –æ–¥–Ω–æ–º —Ç–∞—Ä–∏—Ñ–µ",
          ],
          fact: {
            title: "üîÆ –ú–∞–≥–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç:",
            text: "–£—á–µ–Ω—ã–µ –≤—ã—è—Å–Ω–∏–ª–∏, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≥–æ–ª–æ—Å –ª—é–±–∏–º–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ —Å–Ω–∏–∂–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –∫–æ—Ä—Ç–∏–∑–æ–ª–∞. –ú—ã –ø—Ä–æ–≤–µ–ª–∏ —Å —Ç–æ–±–æ–π 241 —á–∞—Å–æ–≤ –∏–ª–∏ (14 515 –º–∏–Ω) —Å–µ–∞–Ω—Å–æ–≤ –≥–æ–ª–æ—Å–æ–≤–æ–π —Ç–µ—Ä–∞–ø–∏–∏!",
          },
        },
        {
          img: "/liza/q2.png",
          question:
            "–°–∫–æ–ª—å–∫–æ —Ä–∞–∑ ¬´–ª—é–±–ª—é¬ª –∑–≤—É—á–∞–ª–æ —É –Ω–∞—Å, —Å–ª–æ–≤–Ω–æ –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–π –∫–æ–ª–æ–∫–æ–ª—å—á–∏–∫?",
          correct: 1,
          options: [
            "555 –≤ —Å–º—Å –∏ 777 –≤–∂–∏–≤—É—é",
            "372 –≤ —á–∞—Ç–µ –∏ 999 –≤ –∂–∏–∑–Ω–∏",
            "1001 —Ä–∞–∑",
            "444 –≤ –ø–µ—Ä–µ–ø–∏—Å–∫–µ –∏ 888 –Ω–∞—è–≤—É",
          ],
          fact: {
            title: "‚ú® –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç:",
            text: "–ï—Å–ª–∏ –ø–∞—Ä–∞ –ø—Ä–æ–∏–∑–Ω–æ—Å–∏—Ç —Å–ª–æ–≤–∞ –ª—é–±–≤–∏ –±–æ–ª–µ–µ 1000 —Ä–∞–∑ –≤ –≥–æ–¥, –∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è –Ω–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –æ—Å–æ–±–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π. –ú—ã –ø–ª–∞–Ω –ø–µ—Ä–µ–≤—ã–ø–æ–ª–Ω–∏–ª–∏!",
          },
        },
        {
          img: "/liza/q3.png",
          question:
            "–°–∫–æ–ª—å–∫–æ —Å—á–∞—Å—Ç–ª–∏–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –º—ã —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ –≤ –Ω–∞—à–∏—Ö –æ–±—â–∏—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è—Ö?",
          correct: 2,
          options: [
            "42 —Å–Ω–∏–º–∫–∞",
            "99 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π",
            "67 —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö —Ñ–æ—Ç–æ",
            "365 –∫–∞–¥—Ä–æ–≤",
          ],
          fact: {
            title: "üéÑ –ê –∑–Ω–∞–ª–∏ –ª–∏ –≤—ã?",
            text: "–í –Ω–æ–≤–æ–≥–æ–¥–Ω–∏—Ö —Ç—Ä–∞–¥–∏—Ü–∏—è—Ö –º–Ω–æ–≥–∏—Ö —Å—Ç—Ä–∞–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –æ–±—ã—á–∞–π –¥–µ–ª–∞—Ç—å –æ—Å–æ–±—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é —Ä–æ–≤–Ω–æ –≤ –ø–æ–ª–Ω–æ—á—å ‚Äî —Å—á–∏—Ç–∞–µ—Ç—Å—è, —á—Ç–æ –ø–∞—Ä—ã –Ω–∞ —Ç–∞–∫–∏—Ö —Å–Ω–∏–º–∫–∞—Ö –±—É–¥—É—Ç –≤–º–µ—Å—Ç–µ –≤–µ—Å—å —Å–ª–µ–¥—É—é—â–∏–π –≥–æ–¥. –í –ö–∞–Ω–∞–¥–µ –∏ –°–®–ê –≤–ª—é–±–ª–µ–Ω–Ω—ã–µ —Å–æ–∑–¥–∞—é—Ç –∞–ª—å–±–æ–º—ã –ì–æ–¥ –≤–º–µ—Å—Ç–µ, –∫—É–¥–∞ —Å–æ–±–∏—Ä–∞—é—Ç –≤—Å–µ –ø–∞–º—è—Ç–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã",
          },
        },
      ];

      let currentQuizIndex = 0;

      // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –í–ò–ö–¢–û–†–ò–ù–´ ===
      function initQuiz() {
        const stack = document.getElementById("quiz-stack");
        stack.innerHTML = "";

        // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –¥–ª—è z-index
        [...quizData].reverse().forEach((q, reverseIndex) => {
          const realIndex = quizData.length - 1 - reverseIndex;
          const card = document.createElement("div");
          card.className = "quiz-card";
          // –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω –æ–±—ë—Ä—Ç–∫–∏ (pattern-1..pattern-3)
          card.classList.add("pattern-" + ((realIndex % 3) + 1));
          // –ß–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ –º–∞–∫–µ—Ç–∞: –∫–∞—Ä—Ç–∏–Ω–∫–∞ —Å–ª–µ–≤–∞/—Å–ø—Ä–∞–≤–∞ (–Ω–∞ –º–æ–±–∏–ª–∫–µ –≤–µ—Ä—Ö/–Ω–∏–∑)
          if (realIndex % 2 !== 0) card.setAttribute("data-layout", "reverse");

          card.innerHTML = `
                    <div class="card-content">
                        <div class="card-img">
                            <img src="${
                              q.img
                            }" onerror="this.src='https://placehold.co/400x300?text=Photo+${
            realIndex + 1
          }'">
                        </div>
                        <div class="card-body">
                            <div class="question-text">${q.question}</div>
                            <div class="options">
                                ${q.options
                                  .map(
                                    (opt, i) =>
                                      `<button class="option-btn" onclick="handleOptionClick(this, ${realIndex}, ${i})">${opt}</button>`
                                  )
                                  .join("")}
                            </div>
                        </div>
                    </div>
                    <div class="fact-overlay" id="fact-${realIndex}">
                      <div class="fact-answer"></div>
                      <div class="fact-title">${q.fact.title}</div>
                      <div class="fact-text">${q.fact.text}</div>
                      <button class="next-btn" onclick="nextCard(${realIndex})">–î–∞–ª—å—à–µ ‚ù§Ô∏è</button>
                    </div>
                `;
          stack.appendChild(card);
        });
      }

      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
      window.handleOptionClick = function (btn, qIndex, optIndex) {
        const isCorrect = quizData[qIndex].correct === optIndex;
        const parent = btn.parentElement;

        // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏
        const allBtns = parent.querySelectorAll(".option-btn");
        allBtns.forEach((b) => (b.disabled = true));

        if (isCorrect) {
          btn.classList.add("correct");
        } else {
          btn.classList.add("wrong");
          allBtns[quizData[qIndex].correct].classList.add("correct");
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∞–∫—Ç —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É –∏ –¥—É–±–ª–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –≤ –æ–≤–µ—Ä–ª–µ–π
        setTimeout(() => {
          const overlay = document.getElementById(`fact-${qIndex}`);
          if (overlay) {
            const ansEl = overlay.querySelector(".fact-answer");
            if (ansEl) ansEl.innerText = btn.innerText;
            overlay.classList.add("active");
          }
        }, 800);
      };

      // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–µ
      window.nextCard = function (currentIndex) {
        const cards = document.querySelectorAll(".quiz-card");

        // –ü–æ–ø—Ä–æ–±—É–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ –Ω–∞–π—Ç–∏ –∫–∞—Ä—Ç–æ—á–∫—É —á–µ—Ä–µ–∑ –µ—ë –æ–≤–µ—Ä–ª–µ–π (fact-{index}),
        // —Ç.–∫. –∏–Ω–¥–µ–∫—Å—ã –≤ DOM –º–µ–Ω—è—é—Ç—Å—è –ø–æ –º–µ—Ä–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫.
        let activeCard = null;
        const overlay = document.getElementById(`fact-${currentIndex}`);
        if (overlay) activeCard = overlay.closest(".quiz-card");

        // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ —á–µ—Ä–µ–∑ –æ–≤–µ—Ä–ª–µ–π, –ø–æ–ø—Ä–æ–±—É–µ–º —Å—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±, –∏ –≤ –∫—Ä–∞–π–Ω–µ–º
        // —Å–ª—É—á–∞–µ ‚Äî –≤–∑—è—Ç—å –≤–µ—Ä—Ö–Ω—é—é (–ø–æ—Å–ª–µ–¥–Ω—é—é) –∫–∞—Ä—Ç–æ—á–∫—É –≤ —Å—Ç–µ–∫–µ.
        if (!activeCard) {
          activeCard =
            cards[cards.length - 1 - currentIndex] || cards[cards.length - 1];
        }

        // –ó–∞—â–∏—Ç–∞: –µ—Å–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–µ—Ç (—É–∂–µ —É–¥–∞–ª–∏–ª–∏/–Ω–µ —Å–æ–≤–ø–∞–ª –∏–Ω–¥–µ–∫—Å),
        // –Ω–µ –≤—ã–∑—ã–≤–∞–µ–º gsap —Å undefined ‚Äî —Å—Ä–∞–∑—É —Å—á–∏—Ç–∞–µ–º –≤–∏–∫—Ç–æ—Ä–∏–Ω—É –∑–∞–∫–æ–Ω—á–µ–Ω–Ω–æ–π
        if (!activeCard) {
          const remainingCards = document.querySelectorAll(".quiz-card");
          if (remainingCards.length === 0) {
            switchScreen("screen-final", startFinalAnalysis);
            return;
          }
          return;
        }

        // –ê–Ω–∏–º–∏—Ä—É–µ–º –≤—ã–ª–µ—Ç —Ç–µ–∫—É—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–∏ —á–µ—Ä–µ–∑ GSAP (–ø–ª–∞–≤–Ω–æ –∏ –∂–∏–≤–æ)
        gsap.to(activeCard, {
          x: 1000,
          rotation: 25,
          scale: 0.92,
          opacity: 0,
          duration: 0.55,
          ease: "power2.in",
          onComplete: () => {
            // –£–¥–∞–ª—è–µ–º —Ç–µ–∫—É—â—É—é –∫–∞—Ä—Ç–æ—á–∫—É –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            if (activeCard && activeCard.parentNode)
              activeCard.parentNode.removeChild(activeCard);

            // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –∏ –∞–Ω–∏–º–∏—Ä—É–µ–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∫–∞—Ä—Ç–æ—á–∫–∏, —á—Ç–æ–±—ã –æ–Ω–∏ –ø–ª–∞–≤–Ω–æ –∑–∞–Ω—è–ª–∏ –Ω–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏
            const remainingCards = document.querySelectorAll(".quiz-card");
            if (remainingCards.length > 0) {
              remainingCards.forEach((card, idx) => {
                // idx 0 .. n-1, —Ç–æ–ø–æ–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                const posFromTop = remainingCards.length - 1 - idx;
                let rotation = 0,
                  y = 0,
                  scale = 1,
                  opacity = 1,
                  z = 0;

                if (posFromTop === 0) {
                  rotation = 0;
                  y = 0;
                  scale = 1;
                  opacity = 1;
                  z = 3;
                } else if (posFromTop === 1) {
                  rotation = 3;
                  y = 10;
                  scale = 0.98;
                  opacity = 0.95;
                  z = 2;
                } else if (posFromTop === 2) {
                  rotation = -3;
                  y = 20;
                  scale = 0.96;
                  opacity = 0.85;
                  z = 1;
                } else {
                  rotation = 2;
                  y = 30;
                  scale = 0.94;
                  opacity = 0.75;
                  z = 0;
                }

                // –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–ª–∞–≤–Ω—É—é –ø—Ä—É–∂–∏–Ω–∏—Å—Ç—É—é –∞–Ω–∏–º–∞—Ü–∏—é
                gsap.to(card, {
                  rotation: rotation,
                  y: y,
                  scale: scale,
                  opacity: opacity,
                  duration: 0.8,
                  ease: "elastic.out(1, 0.5)",
                  onStart: () => {
                    card.style.zIndex = z;
                  },
                });
              });
            } else {
              // –ù–µ—Ç –±–æ–ª—å—à–µ –∫–∞—Ä—Ç–æ—á–µ–∫ - –≤–∏–∫—Ç–æ—Ä–∏–Ω–∞ –∑–∞–∫–æ–Ω—á–µ–Ω–∞
              switchScreen("screen-final", startFinalAnalysis);
            }
          },
        });
      };

      // === –§–ò–ù–ê–õ–¨–ù–´–ô –≠–ö–†–ê–ù ===
      // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–æ–≤: 0 - –ø–µ—Ä–≤—ã–π –ø–æ–¥–∞—Ä–æ–∫ (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É), 1 - –≤—Ç–æ—Ä–æ–π –ø–æ–¥–∞—Ä–æ–∫ (–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å)
      window.giftStage = 0;
      function startFinalAnalysis() {
        const bar = document.getElementById("loading-bar");
        const percent = document.getElementById("percent-text");
        const analysisCont = document.getElementById("analysis-container");
        const giftCont = document.getElementById("gift-reveal-container");

        let p = 0;
        // –§–∞–∑–∞ 1: –û–±—ã—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ 100%
        const interval = setInterval(() => {
          p += Math.random() * 5;
          if (p > 100) p = 100;
          bar.style.width = p + "%";
          percent.innerText = Math.floor(p) + "%";

          if (p >= 100) {
            clearInterval(interval);
            // –§–∞–∑–∞ 2: –í–∑—Ä—ã–≤ –¥–æ 9999%
            setTimeout(() => {
              bar.classList.add("burst");
              percent.innerText = "9999%";

              // –§–∞–∑–∞ 3: –ò—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ –∏ –ø–æ–¥–∞—Ä–æ–∫
              setTimeout(() => {
                gsap.to(analysisCont, {
                  opacity: 0,
                  duration: 0.5,
                  onComplete: () => {
                    analysisCont.style.display = "none";
                    giftCont.style.display = "flex";
                    // –ü—Ä–∏ –ø–æ–∫–∞–∑–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ –º—ã —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –Ω–∞—á–∏–Ω–∞–µ–º —Å –ø–µ—Ä–≤–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞
                    window.giftStage = 0;
                    gsap.from(giftCont, {
                      opacity: 0,
                      scale: 0.8,
                      duration: 1,
                      ease: "back.out",
                    });
                  },
                });
              }, 2000); // –ø–∞—É–∑–∞ –Ω–∞ –æ—Å–æ–∑–Ω–∞–Ω–∏–µ 9999%
            }, 500);
          }
        }, 100);
      }

      window.flipGiftCard = function () {
        const card = document.getElementById("gift-card-3d");
        const btn = document.getElementById("more-gifts-btn");

        // –ï—Å–ª–∏ —É–∂–µ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∞ - –Ω–µ —Ç—Ä–æ–≥–∞–µ–º, —Ç–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∞ –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å
        if (!card.classList.contains("flipped")) {
          card.classList.add("flipped");

          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ï—â–µ –Ω–µ –≤—Å–µ" –¢–û–õ–¨–ö–û –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞ (giftStage === 0)
          if (window.giftStage === 0) {
            if (btn.style.display !== "block") {
              btn.style.display = "block";
              setTimeout(() => (btn.style.opacity = 1), 500);
            }
          }
        } else {
          // –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –ø–æ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–æ–π –∫–∞—Ä—Ç–µ - –º–æ–∂–Ω–æ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å –æ–±—Ä–∞—Ç–Ω–æ, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å
          // card.classList.remove('flipped');
        }
      };

      window.nextGift = function (e) {
        e.stopPropagation(); // –ß—Ç–æ–±—ã –∫–ª–∏–∫ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É
        const card = document.getElementById("gift-card-3d");
        const frontText = document.getElementById("gift-front-text");
        const img = document.getElementById("gift-img");
        const btn = document.getElementById("more-gifts-btn");

        // 1. –ó–∞–∫—Ä—ã–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É
        card.classList.remove("flipped");

        // 2. –ú–µ–Ω—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ–∫–∞ –æ–Ω–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
        setTimeout(() => {
          frontText.innerText =
            "–Ø —Ä–µ—à–∏–ª —Ç–µ–±–µ –ø–æ–¥–∞—Ä–∏—Ç—å –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è...";
          img.src = "/liza/certificate2.png";
          // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∏ –ø–µ—Ä–µ–≤–æ–¥–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –≤—Ç–æ—Ä–æ–π –ø–æ–¥–∞—Ä–æ–∫
          btn.style.display = "none"; // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É, –±–æ–ª—å—à–µ –ø–æ–¥–∞—Ä–∫–æ–≤ –Ω–µ—Ç (–∏–ª–∏ –¥–æ–±–∞–≤—å –ª–æ–≥–∏–∫—É –¥–ª—è 3-–≥–æ)
          window.giftStage = 1;
        }, 300); // –ü–æ–ª–æ–≤–∏–Ω–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç–∞
      };

      // === –õ–û–ì–ò–ö–ê –ü–ï–†–ï–•–û–î–û–í (–°—Ç–∞—Ä–∞—è) ===
      function switchScreen(nextScreenId, callback) {
        const overlay = document.getElementById("transition-overlay");
        const tl = gsap.timeline();

        // 1. –í—Ö–æ–¥ —à—Ç–æ—Ä–∫–∏
        tl.to(overlay, {
          y: "0%",
          duration: 0.8,
          ease: "power2.inOut",
          onComplete: () => {
            document
              .querySelectorAll(".screen")
              .forEach((s) => s.classList.remove("active"));
            document.getElementById(nextScreenId).classList.add("active");
            if (callback) callback();
          },
        });
        // 2. –í—ã—Ö–æ–¥ —à—Ç–æ—Ä–∫–∏
        tl.to(overlay, {
          y: "100%",
          duration: 0.8,
          ease: "power2.inOut",
          delay: 0.2,
        });
        tl.set(overlay, { y: "-100%" });
      }

      function handleGiftClick() {
        switchScreen("screen-greeting", () => {
          startTreeAnimation();
        });
      }

      function handleLastButton() {
        // –ò–ó–ú–ï–ù–ï–ù–û: –¢–µ–ø–µ—Ä—å –≤–µ–¥–µ—Ç –Ω–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω—É
        switchScreen("screen-quiz", initQuiz);
      }

      // === –õ–û–ì–ò–ö–ê –ê–ù–ò–ú–ê–¶–ò–ò –ï–õ–ö–ò (GSAP) ===
      function startTreeAnimation() {
        if (!window.MorphSVGPlugin || !window.DrawSVGPlugin) {
          gsap.set("#tree-svg", { visibility: "visible", opacity: 1 });
          return;
        }
        // Physics2DPlugin is a paid GSAP plugin. Use free custom kinematics instead.
        gsap.registerPlugin(MorphSVGPlugin, MotionPathPlugin, DrawSVGPlugin);
        function r(a) {
          gsap.killTweensOf(a, { opacity: !0 });
          gsap.fromTo(
            a,
            { opacity: 1 },
            { duration: 0.07, opacity: Math.random(), repeat: -1 }
          );
        }
        function t(a) {
          if (e) {
            a = l[d];
            gsap.set(a, {
              x: gsap.getProperty(".pContainer", "x"),
              y: gsap.getProperty(".pContainer", "y"),
              scale: m(),
            });
            // Free replacement for Physics2DPlugin: calculate final position
            // using simple kinematics and animate with GSAP. This avoids paid plugins.
            var dur = gsap.utils.random(0.61, 6);
            var velocity = gsap.utils.random(5, 60); // px/sec-ish (tunable)
            var angle = gsap.utils.random(-180, 180) * (Math.PI / 180);
            var gravity = gsap.utils.random(-6, 50); // px/sec^2-ish

            var startX = gsap.getProperty(".pContainer", "x") || 0;
            var startY = gsap.getProperty(".pContainer", "y") || 0;

            var vx = velocity * Math.cos(angle);
            var vy = velocity * Math.sin(angle);

            // kinematic final positions after `dur` seconds
            var finalX = startX + vx * dur;
            var finalY = startY + vy * dur + 0.5 * gravity * dur * dur;

            gsap.to(a, {
              duration: dur,
              x: finalX,
              y: finalY,
              scale: 0,
              rotation: gsap.utils.random(-123, 360),
              ease: "power1",
              onStart: r,
              onStartParams: [a],
            });
            d++;
            d = 201 <= d ? 0 : d;
          }
        }
        MorphSVGPlugin.convertToPath("polygon");
        var pContainer = document.querySelector(".pContainer"),
          u = document.querySelector(".mainSVG"),
          c = document.querySelector(".sparkle"),
          e = !0;
        var n =
          "#E8F6F8 #ACE8F8 #F6FBFE #A2CBDC #B74551 #5DBA72 #910B28 #910B28 #446D39".split(
            " "
          );
        var l = [],
          d = 0;
        gsap.set("#tree-svg", { visibility: "visible" });
        gsap.set(c, { transformOrigin: "50% 50%", y: -100 });
        var getPathPoints = function (a) {
          var b = [],
            f = MotionPathPlugin.getRawPath(a)[0];
          f.forEach(function (v, g) {
            var h = {};
            h.x = f[2 * g];
            h.y = f[2 * g + 1];
            g % 2 && b.push(h);
          });
          return b;
        };
        var q = getPathPoints(".treeBottomPath");
        var mainTl = gsap.timeline({ delay: 0, repeat: 0 });
        var k,
          m = gsap.utils.random(0.5, 3, 0.001, !0);
        (function () {
          for (var a = 201; -1 < --a; ) {
            var b = document.createElementNS(
              "http://www.w3.org/2000/svg",
              "circle"
            );
            b.setAttribute("r", gsap.utils.random(1, 3));
            b.setAttribute("fill", n[a % n.length]);
            b.setAttribute("class", "particle");
            u.appendChild(b);
            l.push(b);
            gsap.set(b, { x: -100, y: -100, transformOrigin: "50% 50%" });
          }
        })();
        (function () {
          k = gsap.timeline({ onUpdate: t });
          k.to(".pContainer, .sparkle", {
            duration: 6,
            motionPath: { path: ".treePath", autoRotate: !1 },
            ease: "linear",
          })
            .to(".pContainer, .sparkle", {
              duration: 1,
              onStart: function () {
                e = !1;
              },
              x: q[0].x,
              y: q[0].y,
            })
            .to(
              ".pContainer, .sparkle",
              {
                duration: 2,
                onStart: function () {
                  e = !0;
                },
                motionPath: { path: ".treeBottomPath", autoRotate: !1 },
                ease: "linear",
              },
              "-=0"
            )
            .from(
              ".treeBottomMask",
              { duration: 2, drawSVG: "0% 0%", stroke: "#FFF", ease: "linear" },
              "-=2"
            );
        })();
        mainTl
          .from([".treePathMask", ".treePotMask"], {
            drawSVG: "0% 0%",
            stroke: "#FFF",
            stagger: { each: 6 },
            duration: 6,
            ease: "linear",
          })
          .from(
            ".treeStar",
            {
              duration: 3,
              scaleY: 0,
              scaleX: 0.15,
              transformOrigin: "50% 50%",
              ease: "elastic(1,0.5)",
            },
            "-=4"
          )
          .to(
            ".sparkle",
            {
              duration: 3,
              opacity: 0,
              ease: "rough({strength: 2, points: 100, template: linear, taper: both, randomize: true, clamp: false})",
            },
            "-=0"
          )
          .to(
            ".treeStarOutline",
            {
              duration: 1,
              opacity: 1,
              ease: "rough({strength: 2, points: 16, template: linear, taper: none, randomize: true, clamp: false})",
            },
            "+=1"
          );
        mainTl.add(k, 0);
        gsap.globalTimeline.timeScale(1.5);
      }
    </script>
  </body>
</html>
